{"pageProps":{"post":{"file":"nextjs/nextjs-introduction.md","categories":["nextjs"],"slug":"nextjs$nextjs-introduction","title":"NextJS Error Page Customization","date":"2021-12-12","tags":["nextjs","javascript","typescript","software"],"coverImage":"/imgs/nextjs-logo.webp","author":{"name":"peterhs.kang","picture":"/imgs/PK.png"},"status":"published","excerpt":"\n## Introduction\n\nNext.js provides a static 404 page by default without having to add any additional files.\nBut you should customize the error pages if you would like to render them with your own page layout.\n\n","content":"<h2 id=introduction>Introduction</h2><p>Next.js provides a static 404 page by default without having to add any additional files.<br>But you should customize the error pages if you would like to render them with your own page layout.<h2 id=environment>Environment</h2><pre><code class=\"hljs language-sh\">% node --version\nv14.17.5\n% yarn --version\n1.22.11\n% egrep <span class=hljs-string>'(\"react\"|\"next\")'</span> package.json\n    <span class=hljs-string>\"next\"</span>: <span class=hljs-string>\"~12.0.4\"</span>,\n    <span class=hljs-string>\"react\"</span>: <span class=hljs-string>\"~17.0.2\"</span>,\n</code></pre><h2 id=how-to-customize-the-404-error-page>How to customize the 404 error page</h2><ul><li>create a <code>pages/404.jsx</code> (or .tsx) file.</ul><pre><code class=\"hljs language-js\"><span class=hljs-comment>// pages/404.jsx</span>\n<span class=hljs-keyword>export</span> <span class=hljs-keyword>default</span> <span class=hljs-keyword>function</span> <span class=\"hljs-title hljs-function\">Custom404</span>(<span class=hljs-params></span>) {\n  <span class=hljs-keyword>return</span> <span class=xml><span class=hljs-tag>&lt;<span class=hljs-name>h1</span>></span>404 - Page Not Found<span class=hljs-tag>&#60/<span class=hljs-name>h1</span>></span></span>;\n}\n</code></pre><h2 id=how-to-customize-the-500-error-page>How to customize the 500 error page</h2><ul><li>create a <code>pages/500.jsx</code> (or .tsx) file.</ul><pre><code class=\"hljs language-js\"><span class=hljs-comment>// pages/500.jsx</span>\n<span class=hljs-keyword>export</span> <span class=hljs-keyword>default</span> <span class=hljs-keyword>function</span> <span class=\"hljs-title hljs-function\">Custom500</span>(<span class=hljs-params></span>) {\n  <span class=hljs-keyword>return</span> <span class=xml><span class=hljs-tag>&lt;<span class=hljs-name>h1</span>></span>500 - Server-side error occurred<span class=hljs-tag>&#60/<span class=hljs-name>h1</span>></span></span>;\n}\n</code></pre><h2 id=how-to-customize-all-error-pages>How to customize all error pages</h2><ul><li>create a <code>pages/_error.jsx</code> (or .tsx) file.<li>N.B.<ul><li>pages/_error.js is only used in production.<li>In development youâ€™ll get an error with the call stack to know where the error originated from.</ul></ul><pre><code class=\"hljs language-js\"><span class=hljs-comment>// pages/_error.jsx</span>\n<span class=hljs-keyword>function</span> <span class=\"hljs-title hljs-function\">Error</span>(<span class=hljs-params>{ statusCode }</span>) {\n  <span class=hljs-keyword>return</span> (\n    <span class=xml><span class=hljs-tag>&lt;<span class=hljs-name>p</span>></span>\n      {statusCode\n        ? `An error ${statusCode} occurred on server`\n        : 'An error occurred on client'}\n    <span class=hljs-tag>&#60/<span class=hljs-name>p</span>></span></span>\n  );\n}\n\n<span class=\"hljs-title hljs-class\">Error</span>.<span class=hljs-property>getInitialProps</span> = <span class=hljs-function>(<span class=hljs-params>{ res, err }</span>) =></span> {\n  <span class=hljs-keyword>const</span> statusCode = res ? res.<span class=hljs-property>statusCode</span> : err ? err.<span class=hljs-property>statusCode</span> : <span class=hljs-number>404</span>;\n  <span class=hljs-keyword>return</span> { statusCode };\n}\n</code></pre><h2 id=conclusion>Conclusion</h2><p>You can customize all the error pages with one file, <code>pages/_error.tsx</code>, as below.<br>It works on both CSR(Client-Side Rendering) and SSR(Server-Side Rendering).<pre><code class=\"hljs language-ts\"><span class=hljs-comment>// _error.tsx</span>\n\n<span class=hljs-keyword>import</span> { <span class=\"hljs-title hljs-class\">NextPageContext</span> } <span class=hljs-keyword>from</span> <span class=hljs-string>\"next\"</span>;\n<span class=hljs-keyword>import</span> { <span class=\"hljs-title hljs-class\">PageLayout</span> } <span class=hljs-keyword>from</span> <span class=hljs-string>\"../my-components\"</span>;\n\n<span class=hljs-keyword>interface</span> <span class=\"hljs-title hljs-class\">Props</span> {\n  <span class=hljs-attr>statusCode</span>: <span class=hljs-built_in>number</span>;\n}\n\n<span class=hljs-keyword>export</span> <span class=hljs-keyword>default</span> <span class=hljs-keyword>function</span> <span class=\"hljs-title hljs-function\">Error</span>(<span class=hljs-params>{ statusCode }: Props</span>) {\n  <span class=hljs-keyword>return</span> (\n    <span class=xml><span class=hljs-tag>&lt;<span class=hljs-name>PageLayout</span>></span>\n      <span class=hljs-tag>&lt;<span class=hljs-name>h1</span>></span>\n        {/* CSR env: statusCode is 'undefined'\n            SSR env: statusCode has an error code */}\n        {!statusCode || statusCode === 404\n          ? \"404 - Page Not Found\"\n          : `An error ${statusCode} occurred on server`}\n      <span class=hljs-tag>&#60/<span class=hljs-name>h1</span>></span>\n    <span class=hljs-tag>&#60/<span class=hljs-name>PageLayout</span>></span></span>\n  );\n}\n\n<span class=\"hljs-title hljs-class\">Error</span>.<span class=hljs-property>getInitialProps</span> = <span class=hljs-function>(<span class=hljs-params>{ res, err }: NextPageContext</span>) =></span> {\n  <span class=hljs-keyword>const</span> statusCode = res ? res.<span class=hljs-property>statusCode</span> : err ? err.<span class=hljs-property>statusCode</span> : <span class=hljs-number>404</span>;\n  <span class=hljs-keyword>return</span> { statusCode };\n};\n</code></pre><h2 id=reference>Reference</h2><ul><li><a href=https://nextjs.org/docs/advanced-features/custom-error-page#404-page>Custom Error Page</a></ul>"}},"__N_SSG":true}